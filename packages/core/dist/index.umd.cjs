(function(a,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],u):(a=typeof globalThis<"u"?globalThis:a||self,u(a.VueCmdCore={},a.vue))})(this,function(a,u){"use strict";var br=Object.defineProperty;var _r=(a,u,j)=>u in a?br(a,u,{enumerable:!0,configurable:!0,writable:!0,value:j}):a[u]=j;var De=(a,u,j)=>_r(a,typeof u!="symbol"?u+"":u,j);var j=(e=>(e.destroy="destroy",e))(j||{});class ne{constructor(){De(this,"map",new WeakMap)}getEventsMapByConsumer(t){let n=this.map.get(t);return n||(n=new Map,this.map.set(t,n)),n}getEventsByConsumer(t,n){const r=this.getEventsMapByConsumer(t);let o=r.get(n);return o||(o=new Set,r.set(n,o)),o}on(t,n,r,o={}){const i=this.getEventsByConsumer(t,n);let f=r;o.once&&(f=(...s)=>{r(...s),this.off(t,n,f)}),i.add(f),o.callImmediatelyAfterDelay!==void 0&&setTimeout(()=>{f()},o.callImmediatelyAfterDelay||0)}once(t,n,r,o={}){this.on(t,n,r,{...o,once:!0})}emit(t,n,...r){this.getEventsByConsumer(t,n).forEach(i=>i(...r))}off(t,n,r){this.getEventsByConsumer(t,n).delete(r)}}const ze=(e="")=>e.slice(2).toLowerCase(),Be=(e="")=>`on${e.charAt(0).toUpperCase()}${e.slice(1)}`,re=()=>{let e=()=>{},t=()=>{};return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}},Fe=e=>{var r;const t=((r=e.parentElement)==null?void 0:r.children)||[];let n=0;return Array.from(t).forEach(o=>{if(o!==e){const i=parseInt(window.getComputedStyle(o).zIndex);!isNaN(i)&&i>n&&(n=i)}}),+n},Ue=e=>e==null,He=e=>typeof e!="function"?e:u.h(u.defineComponent({render:()=>e()})),Ge=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),K=Symbol("CommandComponentConsumerInjectKey"),L=Symbol("CommandComponentStackInjectKey"),R=new ne,x=new Set,Ke=()=>{x.forEach(e=>{e.destroy()})},oe=e=>({...e.parent?oe(e.parent):{},...e.provides});function ae(e,t,n){var G;const r=(typeof n.appendTo=="string"?document.querySelector(n.appendTo):n.appendTo)||((G=e.vnode.el)==null?void 0:G.parentElement)||document.body,o=document.createElement("div");o.className=n.customClassName||"command-component-container",r.appendChild(o);const i=()=>{if(d.destroyed)throw new Error("Consumer has been destroyed");n.visible.value=!1},f=()=>{if(d.destroyed)throw new Error("Consumer has been destroyed");n.visible.value=!0},s=()=>{u.nextTick(()=>{u.render(null,o),o.remove()})},{promise:c,resolve:m,reject:p}=re(),g=3e3,T=(h=!1)=>{h?(i(),d.once(j.destroy,s,{once:!0,callImmediatelyAfterDelay:g})):(x.delete(d),d.stack.splice(d.stackIndex).forEach(v=>v.destroy(!0)),d.destroyed=!0)},b=h=>{m(h),T()},_=h=>{p(h),T()},d={meta:n.meta||{},promise:c,resolve:m,reject:p,destroyWithResolve:b,destroyWithReject:_,hide:i,show:f,destroy:T,container:o,visible:n.visible,on:(h,y,v={})=>R.on(d,h,y,v),once:(h,y,v={})=>R.on(d,h,y,v),emit:(h,...y)=>R.emit(d,h,...y),off:(h,y)=>R.off(d,h,y),stack:[],stackIndex:-1,componentRef:void 0,mounted:!1,destroyed:!1},te=u.defineComponent({setup(){for(const v in n.provideProps)u.provide(v,n.provideProps[v]);const h={...oe(e)};for(const v in h)u.provide(v,h[v]);u.provide(K,d);const y=u.inject(L,[]);return d.stackIndex=y.length,y.push(d),u.provide(L,y),d.stack=y,()=>u.h(t)}}),N=u.createVNode(te,null,null);return N.appContext=(e==null?void 0:e.appContext)||N.appContext,u.render(N,o),d.mounted=!0,x.add(d),d}const Le=(e=!0)=>{const t=()=>e&&console.warn(`Failed to get Consumer instance. Please note:
    1. This function needs to be called directly in the setup top level.
    2. Make sure to display this component inside a command dialog, or you can ignore this warning message by using warn parameter: useConsumer(false)`);return u.inject(K,()=>new Proxy({},{get:()=>t,apply:t}),!0)};var ie=typeof global=="object"&&global&&global.Object===Object&&global,We=typeof self=="object"&&self&&self.Object===Object&&self,P=ie||We||Function("return this")(),D=P.Symbol,se=Object.prototype,Ve=se.hasOwnProperty,qe=se.toString,E=D?D.toStringTag:void 0;function Ze(e){var t=Ve.call(e,E),n=e[E];try{e[E]=void 0;var r=!0}catch{}var o=qe.call(e);return r&&(t?e[E]=n:delete e[E]),o}var Xe=Object.prototype,Je=Xe.toString;function Ye(e){return Je.call(e)}var Qe="[object Null]",ke="[object Undefined]",ue=D?D.toStringTag:void 0;function z(e){return e==null?e===void 0?ke:Qe:ue&&ue in Object(e)?Ze(e):Ye(e)}function $(e){return e!=null&&typeof e=="object"}var W=Array.isArray;function O(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function ce(e){return e}var et="[object AsyncFunction]",tt="[object Function]",nt="[object GeneratorFunction]",rt="[object Proxy]";function V(e){if(!O(e))return!1;var t=z(e);return t==tt||t==nt||t==et||t==rt}var q=P["__core-js_shared__"],fe=function(){var e=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function ot(e){return!!fe&&fe in e}var at=Function.prototype,it=at.toString;function st(e){if(e!=null){try{return it.call(e)}catch{}try{return e+""}catch{}}return""}var ut=/[\\^$.*+?()[\]{}|]/g,ct=/^\[object .+?Constructor\]$/,ft=Function.prototype,lt=Object.prototype,dt=ft.toString,pt=lt.hasOwnProperty,ht=RegExp("^"+dt.call(pt).replace(ut,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function mt(e){if(!O(e)||ot(e))return!1;var t=V(e)?ht:ct;return t.test(st(e))}function yt(e,t){return e==null?void 0:e[t]}function Z(e,t){var n=yt(e,t);return mt(n)?n:void 0}var le=Object.create,gt=function(){function e(){}return function(t){if(!O(t))return{};if(le)return le(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function vt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function bt(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var _t=800,Ct=16,Tt=Date.now;function jt(e){var t=0,n=0;return function(){var r=Tt(),o=Ct-(r-n);if(n=r,o>0){if(++t>=_t)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Ot(e){return function(){return e}}var B=function(){try{var e=Z(Object,"defineProperty");return e({},"",{}),e}catch{}}(),wt=B?function(e,t){return B(e,"toString",{configurable:!0,enumerable:!1,value:Ot(t),writable:!0})}:ce,Pt=jt(wt),At=9007199254740991,St=/^(?:0|[1-9]\d*)$/;function de(e,t){var n=typeof e;return t=t??At,!!t&&(n=="number"||n!="symbol"&&St.test(e))&&e>-1&&e%1==0&&e<t}function X(e,t,n){t=="__proto__"&&B?B(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function F(e,t){return e===t||e!==e&&t!==t}var Et=Object.prototype,$t=Et.hasOwnProperty;function It(e,t,n){var r=e[t];(!($t.call(e,t)&&F(r,n))||n===void 0&&!(t in e))&&X(e,t,n)}function Mt(e,t,n,r){var o=!n;n||(n={});for(var i=-1,f=t.length;++i<f;){var s=t[i],c=void 0;c===void 0&&(c=e[s]),o?X(n,s,c):It(n,s,c)}return n}var pe=Math.max;function Nt(e,t,n){return t=pe(t===void 0?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=pe(r.length-t,0),f=Array(i);++o<i;)f[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(f),vt(e,this,s)}}function Rt(e,t){return Pt(Nt(e,t,ce),e+"")}var xt=9007199254740991;function he(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=xt}function J(e){return e!=null&&he(e.length)&&!V(e)}function Dt(e,t,n){if(!O(n))return!1;var r=typeof t;return(r=="number"?J(n)&&de(t,n.length):r=="string"&&t in n)?F(n[t],e):!1}function zt(e){return Rt(function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,f=o>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(o--,i):void 0,f&&Dt(n[0],n[1],f)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r,i)}return t})}var Bt=Object.prototype;function me(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Bt;return e===n}function Ft(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Ut="[object Arguments]";function ye(e){return $(e)&&z(e)==Ut}var ge=Object.prototype,Ht=ge.hasOwnProperty,Gt=ge.propertyIsEnumerable,Y=ye(function(){return arguments}())?ye:function(e){return $(e)&&Ht.call(e,"callee")&&!Gt.call(e,"callee")};function Kt(){return!1}var ve=typeof a=="object"&&a&&!a.nodeType&&a,be=ve&&typeof module=="object"&&module&&!module.nodeType&&module,Lt=be&&be.exports===ve,_e=Lt?P.Buffer:void 0,Wt=_e?_e.isBuffer:void 0,Ce=Wt||Kt,Vt="[object Arguments]",qt="[object Array]",Zt="[object Boolean]",Xt="[object Date]",Jt="[object Error]",Yt="[object Function]",Qt="[object Map]",kt="[object Number]",en="[object Object]",tn="[object RegExp]",nn="[object Set]",rn="[object String]",on="[object WeakMap]",an="[object ArrayBuffer]",sn="[object DataView]",un="[object Float32Array]",cn="[object Float64Array]",fn="[object Int8Array]",ln="[object Int16Array]",dn="[object Int32Array]",pn="[object Uint8Array]",hn="[object Uint8ClampedArray]",mn="[object Uint16Array]",yn="[object Uint32Array]",l={};l[un]=l[cn]=l[fn]=l[ln]=l[dn]=l[pn]=l[hn]=l[mn]=l[yn]=!0,l[Vt]=l[qt]=l[an]=l[Zt]=l[sn]=l[Xt]=l[Jt]=l[Yt]=l[Qt]=l[kt]=l[en]=l[tn]=l[nn]=l[rn]=l[on]=!1;function gn(e){return $(e)&&he(e.length)&&!!l[z(e)]}function vn(e){return function(t){return e(t)}}var Te=typeof a=="object"&&a&&!a.nodeType&&a,I=Te&&typeof module=="object"&&module&&!module.nodeType&&module,bn=I&&I.exports===Te,Q=bn&&ie.process,je=function(){try{var e=I&&I.require&&I.require("util").types;return e||Q&&Q.binding&&Q.binding("util")}catch{}}(),Oe=je&&je.isTypedArray,we=Oe?vn(Oe):gn;function _n(e,t){var n=W(e),r=!n&&Y(e),o=!n&&!r&&Ce(e),i=!n&&!r&&!o&&we(e),f=n||r||o||i,s=f?Ft(e.length,String):[],c=s.length;for(var m in e)f&&(m=="length"||o&&(m=="offset"||m=="parent")||i&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||de(m,c))||s.push(m);return s}function Cn(e,t){return function(n){return e(t(n))}}function Tn(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var jn=Object.prototype,On=jn.hasOwnProperty;function wn(e){if(!O(e))return Tn(e);var t=me(e),n=[];for(var r in e)r=="constructor"&&(t||!On.call(e,r))||n.push(r);return n}function Pe(e){return J(e)?_n(e):wn(e)}var M=Z(Object,"create");function Pn(){this.__data__=M?M(null):{},this.size=0}function An(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Sn="__lodash_hash_undefined__",En=Object.prototype,$n=En.hasOwnProperty;function In(e){var t=this.__data__;if(M){var n=t[e];return n===Sn?void 0:n}return $n.call(t,e)?t[e]:void 0}var Mn=Object.prototype,Nn=Mn.hasOwnProperty;function Rn(e){var t=this.__data__;return M?t[e]!==void 0:Nn.call(t,e)}var xn="__lodash_hash_undefined__";function Dn(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=M&&t===void 0?xn:t,this}function w(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}w.prototype.clear=Pn,w.prototype.delete=An,w.prototype.get=In,w.prototype.has=Rn,w.prototype.set=Dn;function zn(){this.__data__=[],this.size=0}function U(e,t){for(var n=e.length;n--;)if(F(e[n][0],t))return n;return-1}var Bn=Array.prototype,Fn=Bn.splice;function Un(e){var t=this.__data__,n=U(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Fn.call(t,n,1),--this.size,!0}function Hn(e){var t=this.__data__,n=U(t,e);return n<0?void 0:t[n][1]}function Gn(e){return U(this.__data__,e)>-1}function Kn(e,t){var n=this.__data__,r=U(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function C(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}C.prototype.clear=zn,C.prototype.delete=Un,C.prototype.get=Hn,C.prototype.has=Gn,C.prototype.set=Kn;var Ae=Z(P,"Map");function Ln(){this.size=0,this.__data__={hash:new w,map:new(Ae||C),string:new w}}function Wn(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function H(e,t){var n=e.__data__;return Wn(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Vn(e){var t=H(this,e).delete(e);return this.size-=t?1:0,t}function qn(e){return H(this,e).get(e)}function Zn(e){return H(this,e).has(e)}function Xn(e,t){var n=H(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function A(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}A.prototype.clear=Ln,A.prototype.delete=Vn,A.prototype.get=qn,A.prototype.has=Zn,A.prototype.set=Xn;var Se=Cn(Object.getPrototypeOf,Object),Jn="[object Object]",Yn=Function.prototype,Qn=Object.prototype,Ee=Yn.toString,kn=Qn.hasOwnProperty,er=Ee.call(Object);function tr(e){if(!$(e)||z(e)!=Jn)return!1;var t=Se(e);if(t===null)return!0;var n=kn.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Ee.call(n)==er}function nr(){this.__data__=new C,this.size=0}function rr(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function or(e){return this.__data__.get(e)}function ar(e){return this.__data__.has(e)}var ir=200;function sr(e,t){var n=this.__data__;if(n instanceof C){var r=n.__data__;if(!Ae||r.length<ir-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new A(r)}return n.set(e,t),this.size=n.size,this}function S(e){var t=this.__data__=new C(e);this.size=t.size}S.prototype.clear=nr,S.prototype.delete=rr,S.prototype.get=or,S.prototype.has=ar,S.prototype.set=sr;var $e=typeof a=="object"&&a&&!a.nodeType&&a,Ie=$e&&typeof module=="object"&&module&&!module.nodeType&&module,ur=Ie&&Ie.exports===$e,Me=ur?P.Buffer:void 0;Me&&Me.allocUnsafe;function cr(e,t){return e.slice()}var Ne=P.Uint8Array;function fr(e){var t=new e.constructor(e.byteLength);return new Ne(t).set(new Ne(e)),t}function lr(e,t){var n=fr(e.buffer);return new e.constructor(n,e.byteOffset,e.length)}function dr(e){return typeof e.constructor=="function"&&!me(e)?gt(Se(e)):{}}function pr(e){return function(t,n,r){for(var o=-1,i=Object(t),f=r(t),s=f.length;s--;){var c=f[++o];if(n(i[c],c,i)===!1)break}return t}}var hr=pr();function k(e,t,n){(n!==void 0&&!F(e[t],n)||n===void 0&&!(t in e))&&X(e,t,n)}function mr(e){return $(e)&&J(e)}function ee(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function yr(e){return Mt(e,Pe(e))}function gr(e,t,n,r,o,i,f){var s=ee(e,n),c=ee(t,n),m=f.get(c);if(m){k(e,n,m);return}var p=i?i(s,c,n+"",e,t,f):void 0,g=p===void 0;if(g){var T=W(c),b=!T&&Ce(c),_=!T&&!b&&we(c);p=c,T||b||_?W(s)?p=s:mr(s)?p=bt(s):b?(g=!1,p=cr(c)):_?(g=!1,p=lr(c)):p=[]:tr(c)||Y(c)?(p=s,Y(s)?p=yr(s):(!O(s)||V(s))&&(p=dr(c))):g=!1}g&&(f.set(c,p),o(p,c,r,i,f),f.delete(c)),k(e,n,p)}function Re(e,t,n,r,o){e!==t&&hr(t,function(i,f){if(o||(o=new S),O(i))gr(e,t,f,n,Re,r,o);else{var s=r?r(ee(e,f),i,f+"",e,t,o):void 0;s===void 0&&(s=i),k(e,f,s)}},Pe)}var xe=zt(function(e,t,n){Re(e,t,n)});function vr(e){const{render:t,defaultConfig:n={},configTransformer:r}=e;return function(o){const i=u.getCurrentInstance();return function(s,c){const m=u.computed(()=>{const b=typeof o=="function"?o():o,_=typeof c=="function"?c():c;console.log(b,_);const d=xe({},n,b,_);return r?r(d):d}),p=u.ref(!0),g={value:null},T=u.defineComponent({setup:()=>{const b=u.computed(()=>{const N=typeof o=="function"?o():o,G=typeof c=="function"?c():c,h=xe({},n,N,G);return r?r(h):h}),_=u.ref(),te={componentRef:_,onMounted:()=>{Promise.resolve().then(()=>{g.value.componentRef=_})},config:b,consumer:g,visible:p};return()=>t(s,te)}});return g.value=ae(i,u.createVNode(T,null,null),{...m.value,visible:p}),g.value}}}a.CommandComponentConsumerInjectKey=K,a.CommandComponentStackInjectKey=L,a.ConsumerEventBus=ne,a.EVENT_NAME=j,a.PromiseWithResolvers=re,a.RxRender=He,a.activeConsumers=x,a.busName2EventName=Be,a.commandProviderWithRender=ae,a.createAdapter=vr,a.destroyAllConsumer=Ke,a.eventName2BusName=ze,a.getMaxZIndex=Fe,a.isNull=Ue,a.useConsumer=Le,a.uuid=Ge,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
