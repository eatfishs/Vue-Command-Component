(function(i,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("vue"),require("element-plus"),require("vant"),require("vue-router")):typeof define=="function"&&define.amd?define(["exports","vue","element-plus","vant","vue-router"],c):(i=typeof globalThis<"u"?globalThis:i||self,c(i.Vue3CommandDialog={},i.vue,i.elementPlus,i.vant,i.vueRouter))})(this,function(i,c,C,We,Ge){"use strict";var Mr=Object.defineProperty;var $r=(i,c,C)=>c in i?Mr(i,c,{enumerable:!0,configurable:!0,writable:!0,value:C}):i[c]=C;var H=(i,c,C)=>$r(i,typeof c!="symbol"?c+"":c,C);var E=(e=>(e.destroy="destroy",e))(E||{});class oe{constructor(){H(this,"map",new WeakMap)}getEventsMapByConsumer(t){let n=this.map.get(t);return n||(n=new Map,this.map.set(t,n)),n}getEventsByConsumer(t,n){const r=this.getEventsMapByConsumer(t);let o=r.get(n);return o||(o=new Set,r.set(n,o)),o}on(t,n,r,o={}){const s=this.getEventsByConsumer(t,n);let a=r;o.once&&(a=(...u)=>{r(...u),this.off(t,n,a)}),s.add(a),o.callImmediatelyAfterDelay!==void 0&&setTimeout(()=>{a()},o.callImmediatelyAfterDelay||0)}once(t,n,r){this.on(t,n,r,{once:!0})}emit(t,n,...r){this.getEventsByConsumer(t,n).forEach(s=>s(...r))}off(t,n,r){this.getEventsByConsumer(t,n).delete(r)}}const Ke=(e="")=>e.slice(2).toLowerCase(),Le=(e="")=>`on${e.charAt(0).toUpperCase()}${e.slice(1)}`,ae=()=>{let e=()=>{},t=()=>{};return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}},qe=e=>{var r;const t=((r=e.parentElement)==null?void 0:r.children)||[];let n=0;return Array.from(t).forEach(o=>{if(o!==e){const s=parseInt(window.getComputedStyle(o).zIndex);!isNaN(s)&&s>n&&(n=s)}}),+n},se=e=>e==null,ie=(e,t,...n)=>{const r={...e},o=s=>{for(const a in s)if(s[a]&&typeof s[a]=="object"){const u=r[a]&&typeof r[a]=="object"?r[a]:{};r[a]=ie(u,s[a])}else r[a]=s[a]};return o(t),n.forEach(o),r},W=Symbol("CommandComponentConsumerInjectKey"),G=Symbol("CommandComponentStackInjectKey"),N=new oe,D=new Set,ue=()=>{D.forEach(e=>{e.destroy()})},ce=e=>({...e.parent?ce(e.parent):{},...e.provides});function le(e,t,n){var He;const r=(typeof n.appendTo=="string"?document.querySelector(n.appendTo):n.appendTo)||((He=e.vnode.el)==null?void 0:He.parentElement)||document.body,o=document.createElement("div");o.className=n.customClassName||"command-component-container",r.appendChild(o);const s=()=>{if(h.destroyed)throw new Error("Consumer has been destroyed");n.visible.value=!1},a=()=>{if(h.destroyed)throw new Error("Consumer has been destroyed");n.visible.value=!0},u=()=>{c.nextTick(()=>{c.render(null,o),o.remove()})},{promise:l,resolve:p,reject:d}=ae(),m=3e3,y=(g=!1)=>{g?(s(),h.on(E.destroy,u,{once:!0,callImmediatelyAfterDelay:m})):(D.delete(h),h.stack.splice(h.stackIndex).forEach(_=>_.destroy(!0)),h.destroyed=!0)},$=g=>{p(g),y()},V=g=>{d(g),y()},h={meta:n.meta||{},promise:l,resolve:p,reject:d,destroyWithResolve:$,destroyWithReject:V,hide:s,show:a,destroy:y,container:o,visible:n.visible,on:(g,v,_={})=>N.on(h,g,v,_),once:(g,v)=>N.once(h,g,v),emit:(g,...v)=>N.emit(h,g,...v),off:(g,v)=>N.off(h,g,v),stack:[],stackIndex:-1,componentRef:void 0,mounted:!1,destroyed:!1},Ir=c.defineComponent({setup(){for(const _ in n.provideProps)c.provide(_,n.provideProps[_]);const g={...ce(e)};for(const _ in g)c.provide(_,g[_]);c.provide(W,h);const v=c.inject(G,[]);return h.stackIndex=v.length,v.push(h),c.provide(G,v),h.stack=v,()=>c.h(t)}}),re=c.createVNode(Ir,null,null);return re.appContext=(e==null?void 0:e.appContext)||re.appContext,c.render(re,o),h.mounted=!0,D.add(h),h}const Ze=(e=!0)=>{const t=()=>e&&console.warn(`Failed to get Consumer instance. Please note:
    1. This function needs to be called directly in the setup top level.
    2. Make sure to display this component inside a command dialog, or you can ignore this warning message by using warn parameter: useConsumer(false)`);return c.inject(W,()=>new Proxy({},{get:()=>t,apply:t}),!0)};var de=typeof global=="object"&&global&&global.Object===Object&&global,Xe=typeof self=="object"&&self&&self.Object===Object&&self,P=de||Xe||Function("return this")(),R=P.Symbol,fe=Object.prototype,Je=fe.hasOwnProperty,Ye=fe.toString,A=R?R.toStringTag:void 0;function Qe(e){var t=Je.call(e,A),n=e[A];try{e[A]=void 0;var r=!0}catch{}var o=Ye.call(e);return r&&(t?e[A]=n:delete e[A]),o}var ke=Object.prototype,et=ke.toString;function tt(e){return et.call(e)}var nt="[object Null]",rt="[object Undefined]",pe=R?R.toStringTag:void 0;function B(e){return e==null?e===void 0?rt:nt:pe&&pe in Object(e)?Qe(e):tt(e)}function S(e){return e!=null&&typeof e=="object"}var K=Array.isArray;function T(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function he(e){return e}var ot="[object AsyncFunction]",at="[object Function]",st="[object GeneratorFunction]",it="[object Proxy]";function L(e){if(!T(e))return!1;var t=B(e);return t==at||t==st||t==ot||t==it}var q=P["__core-js_shared__"],me=function(){var e=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function ut(e){return!!me&&me in e}var ct=Function.prototype,lt=ct.toString;function dt(e){if(e!=null){try{return lt.call(e)}catch{}try{return e+""}catch{}}return""}var ft=/[\\^$.*+?()[\]{}|]/g,pt=/^\[object .+?Constructor\]$/,ht=Function.prototype,mt=Object.prototype,gt=ht.toString,yt=mt.hasOwnProperty,vt=RegExp("^"+gt.call(yt).replace(ft,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bt(e){if(!T(e)||ut(e))return!1;var t=L(e)?vt:pt;return t.test(dt(e))}function _t(e,t){return e==null?void 0:e[t]}function Z(e,t){var n=_t(e,t);return bt(n)?n:void 0}var ge=Object.create,Ct=function(){function e(){}return function(t){if(!T(t))return{};if(ge)return ge(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Tt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function wt(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Pt=800,jt=16,Ot=Date.now;function Et(e){var t=0,n=0;return function(){var r=Ot(),o=jt-(r-n);if(n=r,o>0){if(++t>=Pt)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function At(e){return function(){return e}}var U=function(){try{var e=Z(Object,"defineProperty");return e({},"",{}),e}catch{}}(),St=U?function(e,t){return U(e,"toString",{configurable:!0,enumerable:!1,value:At(t),writable:!0})}:he,It=Et(St),Mt=9007199254740991,$t=/^(?:0|[1-9]\d*)$/;function ye(e,t){var n=typeof e;return t=t??Mt,!!t&&(n=="number"||n!="symbol"&&$t.test(e))&&e>-1&&e%1==0&&e<t}function X(e,t,n){t=="__proto__"&&U?U(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function x(e,t){return e===t||e!==e&&t!==t}var Nt=Object.prototype,Dt=Nt.hasOwnProperty;function Rt(e,t,n){var r=e[t];(!(Dt.call(e,t)&&x(r,n))||n===void 0&&!(t in e))&&X(e,t,n)}function Bt(e,t,n,r){var o=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var u=t[s],l=void 0;l===void 0&&(l=e[u]),o?X(n,u,l):Rt(n,u,l)}return n}var ve=Math.max;function Ut(e,t,n){return t=ve(t===void 0?e.length-1:t,0),function(){for(var r=arguments,o=-1,s=ve(r.length-t,0),a=Array(s);++o<s;)a[o]=r[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=r[o];return u[t]=n(a),Tt(e,this,u)}}function xt(e,t){return It(Ut(e,t,he),e+"")}var zt=9007199254740991;function be(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=zt}function J(e){return e!=null&&be(e.length)&&!L(e)}function Ft(e,t,n){if(!T(n))return!1;var r=typeof t;return(r=="number"?J(n)&&ye(t,n.length):r=="string"&&t in n)?x(n[t],e):!1}function Vt(e){return xt(function(t,n){var r=-1,o=n.length,s=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(s=e.length>3&&typeof s=="function"?(o--,s):void 0,a&&Ft(n[0],n[1],a)&&(s=o<3?void 0:s,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,s)}return t})}var Ht=Object.prototype;function _e(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Ht;return e===n}function Wt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Gt="[object Arguments]";function Ce(e){return S(e)&&B(e)==Gt}var Te=Object.prototype,Kt=Te.hasOwnProperty,Lt=Te.propertyIsEnumerable,Y=Ce(function(){return arguments}())?Ce:function(e){return S(e)&&Kt.call(e,"callee")&&!Lt.call(e,"callee")};function qt(){return!1}var we=typeof i=="object"&&i&&!i.nodeType&&i,Pe=we&&typeof module=="object"&&module&&!module.nodeType&&module,Zt=Pe&&Pe.exports===we,je=Zt?P.Buffer:void 0,Xt=je?je.isBuffer:void 0,Oe=Xt||qt,Jt="[object Arguments]",Yt="[object Array]",Qt="[object Boolean]",kt="[object Date]",en="[object Error]",tn="[object Function]",nn="[object Map]",rn="[object Number]",on="[object Object]",an="[object RegExp]",sn="[object Set]",un="[object String]",cn="[object WeakMap]",ln="[object ArrayBuffer]",dn="[object DataView]",fn="[object Float32Array]",pn="[object Float64Array]",hn="[object Int8Array]",mn="[object Int16Array]",gn="[object Int32Array]",yn="[object Uint8Array]",vn="[object Uint8ClampedArray]",bn="[object Uint16Array]",_n="[object Uint32Array]",f={};f[fn]=f[pn]=f[hn]=f[mn]=f[gn]=f[yn]=f[vn]=f[bn]=f[_n]=!0,f[Jt]=f[Yt]=f[ln]=f[Qt]=f[dn]=f[kt]=f[en]=f[tn]=f[nn]=f[rn]=f[on]=f[an]=f[sn]=f[un]=f[cn]=!1;function Cn(e){return S(e)&&be(e.length)&&!!f[B(e)]}function Tn(e){return function(t){return e(t)}}var Ee=typeof i=="object"&&i&&!i.nodeType&&i,I=Ee&&typeof module=="object"&&module&&!module.nodeType&&module,wn=I&&I.exports===Ee,Q=wn&&de.process,Ae=function(){try{var e=I&&I.require&&I.require("util").types;return e||Q&&Q.binding&&Q.binding("util")}catch{}}(),Se=Ae&&Ae.isTypedArray,Ie=Se?Tn(Se):Cn;function Pn(e,t){var n=K(e),r=!n&&Y(e),o=!n&&!r&&Oe(e),s=!n&&!r&&!o&&Ie(e),a=n||r||o||s,u=a?Wt(e.length,String):[],l=u.length;for(var p in e)a&&(p=="length"||o&&(p=="offset"||p=="parent")||s&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||ye(p,l))||u.push(p);return u}function jn(e,t){return function(n){return e(t(n))}}function On(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var En=Object.prototype,An=En.hasOwnProperty;function Sn(e){if(!T(e))return On(e);var t=_e(e),n=[];for(var r in e)r=="constructor"&&(t||!An.call(e,r))||n.push(r);return n}function Me(e){return J(e)?Pn(e):Sn(e)}var M=Z(Object,"create");function In(){this.__data__=M?M(null):{},this.size=0}function Mn(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var $n="__lodash_hash_undefined__",Nn=Object.prototype,Dn=Nn.hasOwnProperty;function Rn(e){var t=this.__data__;if(M){var n=t[e];return n===$n?void 0:n}return Dn.call(t,e)?t[e]:void 0}var Bn=Object.prototype,Un=Bn.hasOwnProperty;function xn(e){var t=this.__data__;return M?t[e]!==void 0:Un.call(t,e)}var zn="__lodash_hash_undefined__";function Fn(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=M&&t===void 0?zn:t,this}function w(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}w.prototype.clear=In,w.prototype.delete=Mn,w.prototype.get=Rn,w.prototype.has=xn,w.prototype.set=Fn;function Vn(){this.__data__=[],this.size=0}function z(e,t){for(var n=e.length;n--;)if(x(e[n][0],t))return n;return-1}var Hn=Array.prototype,Wn=Hn.splice;function Gn(e){var t=this.__data__,n=z(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Wn.call(t,n,1),--this.size,!0}function Kn(e){var t=this.__data__,n=z(t,e);return n<0?void 0:t[n][1]}function Ln(e){return z(this.__data__,e)>-1}function qn(e,t){var n=this.__data__,r=z(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function b(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}b.prototype.clear=Vn,b.prototype.delete=Gn,b.prototype.get=Kn,b.prototype.has=Ln,b.prototype.set=qn;var $e=Z(P,"Map");function Zn(){this.size=0,this.__data__={hash:new w,map:new($e||b),string:new w}}function Xn(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function F(e,t){var n=e.__data__;return Xn(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Jn(e){var t=F(this,e).delete(e);return this.size-=t?1:0,t}function Yn(e){return F(this,e).get(e)}function Qn(e){return F(this,e).has(e)}function kn(e,t){var n=F(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function j(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}j.prototype.clear=Zn,j.prototype.delete=Jn,j.prototype.get=Yn,j.prototype.has=Qn,j.prototype.set=kn;var Ne=jn(Object.getPrototypeOf,Object),er="[object Object]",tr=Function.prototype,nr=Object.prototype,De=tr.toString,rr=nr.hasOwnProperty,or=De.call(Object);function ar(e){if(!S(e)||B(e)!=er)return!1;var t=Ne(e);if(t===null)return!0;var n=rr.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&De.call(n)==or}function sr(){this.__data__=new b,this.size=0}function ir(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function ur(e){return this.__data__.get(e)}function cr(e){return this.__data__.has(e)}var lr=200;function dr(e,t){var n=this.__data__;if(n instanceof b){var r=n.__data__;if(!$e||r.length<lr-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new j(r)}return n.set(e,t),this.size=n.size,this}function O(e){var t=this.__data__=new b(e);this.size=t.size}O.prototype.clear=sr,O.prototype.delete=ir,O.prototype.get=ur,O.prototype.has=cr,O.prototype.set=dr;var Re=typeof i=="object"&&i&&!i.nodeType&&i,Be=Re&&typeof module=="object"&&module&&!module.nodeType&&module,fr=Be&&Be.exports===Re,Ue=fr?P.Buffer:void 0;Ue&&Ue.allocUnsafe;function pr(e,t){return e.slice()}var xe=P.Uint8Array;function hr(e){var t=new e.constructor(e.byteLength);return new xe(t).set(new xe(e)),t}function mr(e,t){var n=hr(e.buffer);return new e.constructor(n,e.byteOffset,e.length)}function gr(e){return typeof e.constructor=="function"&&!_e(e)?Ct(Ne(e)):{}}function yr(e){return function(t,n,r){for(var o=-1,s=Object(t),a=r(t),u=a.length;u--;){var l=a[++o];if(n(s[l],l,s)===!1)break}return t}}var vr=yr();function k(e,t,n){(n!==void 0&&!x(e[t],n)||n===void 0&&!(t in e))&&X(e,t,n)}function br(e){return S(e)&&J(e)}function ee(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function _r(e){return Bt(e,Me(e))}function Cr(e,t,n,r,o,s,a){var u=ee(e,n),l=ee(t,n),p=a.get(l);if(p){k(e,n,p);return}var d=s?s(u,l,n+"",e,t,a):void 0,m=d===void 0;if(m){var y=K(l),$=!y&&Oe(l),V=!y&&!$&&Ie(l);d=l,y||$||V?K(u)?d=u:br(u)?d=wt(u):$?(m=!1,d=pr(l)):V?(m=!1,d=mr(l)):d=[]:ar(l)||Y(l)?(d=u,Y(u)?d=_r(u):(!T(u)||L(u))&&(d=gr(l))):m=!1}m&&(a.set(l,d),o(d,l,r,s,a),a.delete(l)),k(e,n,d)}function ze(e,t,n,r,o){e!==t&&vr(t,function(s,a){if(o||(o=new O),T(s))Cr(e,t,a,n,ze,r,o);else{var u=r?r(ee(e,a),s,a+"",e,t,o):void 0;u===void 0&&(u=s),k(e,a,u)}},Me)}var te=Vt(function(e,t,n){ze(e,t,n)});class ne{constructor(){H(this,"mountNode");H(this,"parentInstance");this.parentInstance=c.getCurrentInstance()}setMountNode(t){this.mountNode=t}createCommand(t){return(n,r={})=>{const o=c.ref(se(t.visible)?!0:!!t.visible);return this.createConsumer(n,o,r,t)}}createConsumer(t,n,r,o){const s={value:null},a=c.defineComponent({setup:()=>{const p=c.ref(),d=()=>{Promise.resolve().then(()=>{s.value.componentRef=p})};return()=>this.renderComponent(t,{componentRef:p,visible:n.value,onMounted:d,config:r,consumer:s})}}),l={...te(o,r),visible:n};return s.value=le(this.parentInstance,c.h(a),l),s.value}}class Tr extends ne{renderComponent(t,n){const{componentRef:r,visible:o,onMounted:s,config:a,consumer:u}=n,l=d=>{d(),u.value.destroy()},p=(...d)=>{var m,y;return u.value.emit(E.destroy),(y=(m=a.attrs)==null?void 0:m.onClosed)==null?void 0:y.call(m,...d)};return c.createVNode(C.ElDialog,c.mergeProps({ref:r,modelValue:o,beforeClose:l,onVnodeMounted:s,title:a.title,width:a.width},{...a.attrs},{onClosed:p}),{default:()=>t,...a.slots})}}const Fe=(e={})=>{const t=new Tr;return t.setMountNode(e.appendTo),t.createCommand(e)},wr=(e={})=>{const t=Fe(e);return(n,r={})=>{const o=te({},r,{attrs:{draggable:!0}});return t(n,o)}};class Pr extends ne{renderComponent(t,n){const{componentRef:r,visible:o,onMounted:s,config:a,consumer:u}=n,l=d=>{d(),u.value.destroy()},p=(...d)=>{var m,y;return u.value.emit(E.destroy),(y=(m=a.attrs)==null?void 0:m.onClosed)==null?void 0:y.call(m,...d)};return c.createVNode(C.ElDrawer,c.mergeProps({ref:r,modelValue:o,beforeClose:l,onVnodeMounted:s},{title:a.title,...a.attrs},{onClosed:p}),{default:()=>t,...a.slots})}}const jr=(e={})=>{const t=new Pr;return t.setMountNode(e.appendTo),t.createCommand(e)},Or={round:!0,lockScroll:!0,closeable:!0,style:{backgroundColor:"#fff",color:"#000"}};class Er extends ne{renderComponent(t,n){const{componentRef:r,visible:o,onMounted:s,config:a,consumer:u}=n,l=()=>{u.value.destroy()};return c.createVNode(We.Popup,c.mergeProps({ref:r,show:o,onClickCloseIcon:l,onVnodeMounted:s},{...Or,...a.attrs}),{default:()=>t,...a.slots})}}const Ve=(e={})=>{const t=new Er;return t.setMountNode(e.appendTo),t.createCommand(e)},Ar=(e={})=>{const t=Ve(e);return(n,r={})=>{const o=te({},r,{attrs:{position:"bottom",style:{width:"100vw"}}});return t(n,o)}},Sr=()=>{const e=Ge.useRoute();c.watch(()=>e.path,()=>{ue()})};i.CommandComponentConsumerInjectKey=W,i.CommandComponentStackInjectKey=G,i.CommandProviderWithRender=le,i.ConsumerEventBus=oe,i.EVENT_NAME=E,i.PromiseWithResolvers=ae,i.activeConsumers=D,i.busName2EventName=Le,i.deepMerge=ie,i.destroyAllConsumer=ue,i.eventName2BusName=Ke,i.getMaxZIndex=qe,i.isNull=se,i.useCloseAllOnRouteChange=Sr,i.useConsumer=Ze,i.useElementPlusDialog=Fe,i.useElementPlusDialogWithDrag=wr,i.useElementPlusDrawer=jr,i.useVantUiPopup=Ve,i.useVantUiPopupOnBottom=Ar,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
