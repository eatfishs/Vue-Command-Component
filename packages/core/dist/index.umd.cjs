(function(i,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],c):(i=typeof globalThis<"u"?globalThis:i||self,c(i.VueCmdCore={},i.vue))})(this,function(i,c){"use strict";var gr=Object.defineProperty;var br=(i,c,C)=>c in i?gr(i,c,{enumerable:!0,configurable:!0,writable:!0,value:C}):i[c]=C;var ze=(i,c,C)=>br(i,typeof c!="symbol"?c+"":c,C);var C=(e=>(e.destroy="destroy",e))(C||{});class ne{constructor(){ze(this,"map",new WeakMap)}getEventsMapByConsumer(t){let n=this.map.get(t);return n||(n=new Map,this.map.set(t,n)),n}getEventsByConsumer(t,n){const r=this.getEventsMapByConsumer(t);let o=r.get(n);return o||(o=new Set,r.set(n,o)),o}on(t,n,r,o={}){const a=this.getEventsByConsumer(t,n);let u=r;o.once&&(u=(...s)=>{r(...s),this.off(t,n,u)}),a.add(u),o.callImmediatelyAfterDelay!==void 0&&setTimeout(()=>{u()},o.callImmediatelyAfterDelay||0)}once(t,n,r){this.on(t,n,r,{once:!0})}emit(t,n,...r){this.getEventsByConsumer(t,n).forEach(a=>a(...r))}off(t,n,r){this.getEventsByConsumer(t,n).delete(r)}}const Be=(e="")=>e.slice(2).toLowerCase(),De=(e="")=>`on${e.charAt(0).toUpperCase()}${e.slice(1)}`,re=()=>{let e=()=>{},t=()=>{};return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}},Fe=e=>{var r;const t=((r=e.parentElement)==null?void 0:r.children)||[];let n=0;return Array.from(t).forEach(o=>{if(o!==e){const a=parseInt(window.getComputedStyle(o).zIndex);!isNaN(a)&&a>n&&(n=a)}}),+n},Ue=e=>e==null,He=e=>typeof e!="function"?e:c.h(c.defineComponent({render:()=>e()})),L=Symbol("CommandComponentConsumerInjectKey"),W=Symbol("CommandComponentStackInjectKey"),N=new ne,R=new Set,Ge=()=>{R.forEach(e=>{e.destroy()})},oe=e=>({...e.parent?oe(e.parent):{},...e.provides});function ae(e,t,n){var K;const r=(typeof n.appendTo=="string"?document.querySelector(n.appendTo):n.appendTo)||((K=e.vnode.el)==null?void 0:K.parentElement)||document.body,o=document.createElement("div");o.className=n.customClassName||"command-component-container",r.appendChild(o);const a=()=>{if(d.destroyed)throw new Error("Consumer has been destroyed");n.visible.value=!1},u=()=>{if(d.destroyed)throw new Error("Consumer has been destroyed");n.visible.value=!0},s=()=>{c.nextTick(()=>{c.render(null,o),o.remove()})},{promise:f,resolve:h,reject:p}=re(),g=3e3,v=(m=!1)=>{m?(a(),d.on(C.destroy,s,{once:!0,callImmediatelyAfterDelay:g})):(R.delete(d),d.stack.splice(d.stackIndex).forEach(_=>_.destroy(!0)),d.destroyed=!0)},O=m=>{h(m),v()},M=m=>{p(m),v()},d={meta:n.meta||{},promise:f,resolve:h,reject:p,destroyWithResolve:O,destroyWithReject:M,hide:a,show:u,destroy:v,container:o,visible:n.visible,on:(m,y,_={})=>N.on(d,m,y,_),once:(m,y)=>N.once(d,m,y),emit:(m,...y)=>N.emit(d,m,...y),off:(m,y)=>N.off(d,m,y),stack:[],stackIndex:-1,componentRef:void 0,mounted:!1,destroyed:!1},H=c.defineComponent({setup(){for(const _ in n.provideProps)c.provide(_,n.provideProps[_]);const m={...oe(e)};for(const _ in m)c.provide(_,m[_]);c.provide(L,d);const y=c.inject(W,[]);return d.stackIndex=y.length,y.push(d),c.provide(W,y),d.stack=y,()=>c.h(t)}}),G=c.createVNode(H,null,null);return G.appContext=(e==null?void 0:e.appContext)||G.appContext,c.render(G,o),d.mounted=!0,R.add(d),d}const Ke=(e=!0)=>{const t=()=>e&&console.warn(`Failed to get Consumer instance. Please note:
    1. This function needs to be called directly in the setup top level.
    2. Make sure to display this component inside a command dialog, or you can ignore this warning message by using warn parameter: useConsumer(false)`);return c.inject(L,()=>new Proxy({},{get:()=>t,apply:t}),!0)};var ie=typeof global=="object"&&global&&global.Object===Object&&global,Le=typeof self=="object"&&self&&self.Object===Object&&self,w=ie||Le||Function("return this")(),x=w.Symbol,se=Object.prototype,We=se.hasOwnProperty,Ve=se.toString,E=x?x.toStringTag:void 0;function qe(e){var t=We.call(e,E),n=e[E];try{e[E]=void 0;var r=!0}catch{}var o=Ve.call(e);return r&&(t?e[E]=n:delete e[E]),o}var Ze=Object.prototype,Xe=Ze.toString;function Je(e){return Xe.call(e)}var Ye="[object Null]",Qe="[object Undefined]",ue=x?x.toStringTag:void 0;function z(e){return e==null?e===void 0?Qe:Ye:ue&&ue in Object(e)?qe(e):Je(e)}function S(e){return e!=null&&typeof e=="object"}var V=Array.isArray;function T(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function ce(e){return e}var ke="[object AsyncFunction]",et="[object Function]",tt="[object GeneratorFunction]",nt="[object Proxy]";function q(e){if(!T(e))return!1;var t=z(e);return t==et||t==tt||t==ke||t==nt}var Z=w["__core-js_shared__"],fe=function(){var e=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function rt(e){return!!fe&&fe in e}var ot=Function.prototype,at=ot.toString;function it(e){if(e!=null){try{return at.call(e)}catch{}try{return e+""}catch{}}return""}var st=/[\\^$.*+?()[\]{}|]/g,ut=/^\[object .+?Constructor\]$/,ct=Function.prototype,ft=Object.prototype,lt=ct.toString,dt=ft.hasOwnProperty,pt=RegExp("^"+lt.call(dt).replace(st,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ht(e){if(!T(e)||rt(e))return!1;var t=q(e)?pt:ut;return t.test(it(e))}function mt(e,t){return e==null?void 0:e[t]}function X(e,t){var n=mt(e,t);return ht(n)?n:void 0}var le=Object.create,yt=function(){function e(){}return function(t){if(!T(t))return{};if(le)return le(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function vt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function gt(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var bt=800,_t=16,Ct=Date.now;function Tt(e){var t=0,n=0;return function(){var r=Ct(),o=_t-(r-n);if(n=r,o>0){if(++t>=bt)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function jt(e){return function(){return e}}var B=function(){try{var e=X(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Ot=B?function(e,t){return B(e,"toString",{configurable:!0,enumerable:!1,value:jt(t),writable:!0})}:ce,wt=Tt(Ot),Pt=9007199254740991,At=/^(?:0|[1-9]\d*)$/;function de(e,t){var n=typeof e;return t=t??Pt,!!t&&(n=="number"||n!="symbol"&&At.test(e))&&e>-1&&e%1==0&&e<t}function J(e,t,n){t=="__proto__"&&B?B(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function D(e,t){return e===t||e!==e&&t!==t}var Et=Object.prototype,St=Et.hasOwnProperty;function $t(e,t,n){var r=e[t];(!(St.call(e,t)&&D(r,n))||n===void 0&&!(t in e))&&J(e,t,n)}function It(e,t,n,r){var o=!n;n||(n={});for(var a=-1,u=t.length;++a<u;){var s=t[a],f=void 0;f===void 0&&(f=e[s]),o?J(n,s,f):$t(n,s,f)}return n}var pe=Math.max;function Mt(e,t,n){return t=pe(t===void 0?e.length-1:t,0),function(){for(var r=arguments,o=-1,a=pe(r.length-t,0),u=Array(a);++o<a;)u[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(u),vt(e,this,s)}}function Nt(e,t){return wt(Mt(e,t,ce),e+"")}var Rt=9007199254740991;function he(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Rt}function Y(e){return e!=null&&he(e.length)&&!q(e)}function xt(e,t,n){if(!T(n))return!1;var r=typeof t;return(r=="number"?Y(n)&&de(t,n.length):r=="string"&&t in n)?D(n[t],e):!1}function zt(e){return Nt(function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,u=o>2?n[2]:void 0;for(a=e.length>3&&typeof a=="function"?(o--,a):void 0,u&&xt(n[0],n[1],u)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r,a)}return t})}var Bt=Object.prototype;function me(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Bt;return e===n}function Dt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Ft="[object Arguments]";function ye(e){return S(e)&&z(e)==Ft}var ve=Object.prototype,Ut=ve.hasOwnProperty,Ht=ve.propertyIsEnumerable,Q=ye(function(){return arguments}())?ye:function(e){return S(e)&&Ut.call(e,"callee")&&!Ht.call(e,"callee")};function Gt(){return!1}var ge=typeof i=="object"&&i&&!i.nodeType&&i,be=ge&&typeof module=="object"&&module&&!module.nodeType&&module,Kt=be&&be.exports===ge,_e=Kt?w.Buffer:void 0,Lt=_e?_e.isBuffer:void 0,Ce=Lt||Gt,Wt="[object Arguments]",Vt="[object Array]",qt="[object Boolean]",Zt="[object Date]",Xt="[object Error]",Jt="[object Function]",Yt="[object Map]",Qt="[object Number]",kt="[object Object]",en="[object RegExp]",tn="[object Set]",nn="[object String]",rn="[object WeakMap]",on="[object ArrayBuffer]",an="[object DataView]",sn="[object Float32Array]",un="[object Float64Array]",cn="[object Int8Array]",fn="[object Int16Array]",ln="[object Int32Array]",dn="[object Uint8Array]",pn="[object Uint8ClampedArray]",hn="[object Uint16Array]",mn="[object Uint32Array]",l={};l[sn]=l[un]=l[cn]=l[fn]=l[ln]=l[dn]=l[pn]=l[hn]=l[mn]=!0,l[Wt]=l[Vt]=l[on]=l[qt]=l[an]=l[Zt]=l[Xt]=l[Jt]=l[Yt]=l[Qt]=l[kt]=l[en]=l[tn]=l[nn]=l[rn]=!1;function yn(e){return S(e)&&he(e.length)&&!!l[z(e)]}function vn(e){return function(t){return e(t)}}var Te=typeof i=="object"&&i&&!i.nodeType&&i,$=Te&&typeof module=="object"&&module&&!module.nodeType&&module,gn=$&&$.exports===Te,k=gn&&ie.process,je=function(){try{var e=$&&$.require&&$.require("util").types;return e||k&&k.binding&&k.binding("util")}catch{}}(),Oe=je&&je.isTypedArray,we=Oe?vn(Oe):yn;function bn(e,t){var n=V(e),r=!n&&Q(e),o=!n&&!r&&Ce(e),a=!n&&!r&&!o&&we(e),u=n||r||o||a,s=u?Dt(e.length,String):[],f=s.length;for(var h in e)u&&(h=="length"||o&&(h=="offset"||h=="parent")||a&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||de(h,f))||s.push(h);return s}function _n(e,t){return function(n){return e(t(n))}}function Cn(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var Tn=Object.prototype,jn=Tn.hasOwnProperty;function On(e){if(!T(e))return Cn(e);var t=me(e),n=[];for(var r in e)r=="constructor"&&(t||!jn.call(e,r))||n.push(r);return n}function Pe(e){return Y(e)?bn(e):On(e)}var I=X(Object,"create");function wn(){this.__data__=I?I(null):{},this.size=0}function Pn(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var An="__lodash_hash_undefined__",En=Object.prototype,Sn=En.hasOwnProperty;function $n(e){var t=this.__data__;if(I){var n=t[e];return n===An?void 0:n}return Sn.call(t,e)?t[e]:void 0}var In=Object.prototype,Mn=In.hasOwnProperty;function Nn(e){var t=this.__data__;return I?t[e]!==void 0:Mn.call(t,e)}var Rn="__lodash_hash_undefined__";function xn(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=I&&t===void 0?Rn:t,this}function j(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}j.prototype.clear=wn,j.prototype.delete=Pn,j.prototype.get=$n,j.prototype.has=Nn,j.prototype.set=xn;function zn(){this.__data__=[],this.size=0}function F(e,t){for(var n=e.length;n--;)if(D(e[n][0],t))return n;return-1}var Bn=Array.prototype,Dn=Bn.splice;function Fn(e){var t=this.__data__,n=F(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Dn.call(t,n,1),--this.size,!0}function Un(e){var t=this.__data__,n=F(t,e);return n<0?void 0:t[n][1]}function Hn(e){return F(this.__data__,e)>-1}function Gn(e,t){var n=this.__data__,r=F(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function b(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}b.prototype.clear=zn,b.prototype.delete=Fn,b.prototype.get=Un,b.prototype.has=Hn,b.prototype.set=Gn;var Ae=X(w,"Map");function Kn(){this.size=0,this.__data__={hash:new j,map:new(Ae||b),string:new j}}function Ln(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function U(e,t){var n=e.__data__;return Ln(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Wn(e){var t=U(this,e).delete(e);return this.size-=t?1:0,t}function Vn(e){return U(this,e).get(e)}function qn(e){return U(this,e).has(e)}function Zn(e,t){var n=U(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function P(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}P.prototype.clear=Kn,P.prototype.delete=Wn,P.prototype.get=Vn,P.prototype.has=qn,P.prototype.set=Zn;var Ee=_n(Object.getPrototypeOf,Object),Xn="[object Object]",Jn=Function.prototype,Yn=Object.prototype,Se=Jn.toString,Qn=Yn.hasOwnProperty,kn=Se.call(Object);function er(e){if(!S(e)||z(e)!=Xn)return!1;var t=Ee(e);if(t===null)return!0;var n=Qn.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Se.call(n)==kn}function tr(){this.__data__=new b,this.size=0}function nr(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function rr(e){return this.__data__.get(e)}function or(e){return this.__data__.has(e)}var ar=200;function ir(e,t){var n=this.__data__;if(n instanceof b){var r=n.__data__;if(!Ae||r.length<ar-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new P(r)}return n.set(e,t),this.size=n.size,this}function A(e){var t=this.__data__=new b(e);this.size=t.size}A.prototype.clear=tr,A.prototype.delete=nr,A.prototype.get=rr,A.prototype.has=or,A.prototype.set=ir;var $e=typeof i=="object"&&i&&!i.nodeType&&i,Ie=$e&&typeof module=="object"&&module&&!module.nodeType&&module,sr=Ie&&Ie.exports===$e,Me=sr?w.Buffer:void 0;Me&&Me.allocUnsafe;function ur(e,t){return e.slice()}var Ne=w.Uint8Array;function cr(e){var t=new e.constructor(e.byteLength);return new Ne(t).set(new Ne(e)),t}function fr(e,t){var n=cr(e.buffer);return new e.constructor(n,e.byteOffset,e.length)}function lr(e){return typeof e.constructor=="function"&&!me(e)?yt(Ee(e)):{}}function dr(e){return function(t,n,r){for(var o=-1,a=Object(t),u=r(t),s=u.length;s--;){var f=u[++o];if(n(a[f],f,a)===!1)break}return t}}var pr=dr();function ee(e,t,n){(n!==void 0&&!D(e[t],n)||n===void 0&&!(t in e))&&J(e,t,n)}function hr(e){return S(e)&&Y(e)}function te(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function mr(e){return It(e,Pe(e))}function yr(e,t,n,r,o,a,u){var s=te(e,n),f=te(t,n),h=u.get(f);if(h){ee(e,n,h);return}var p=a?a(s,f,n+"",e,t,u):void 0,g=p===void 0;if(g){var v=V(f),O=!v&&Ce(f),M=!v&&!O&&we(f);p=f,v||O||M?V(s)?p=s:hr(s)?p=gt(s):O?(g=!1,p=ur(f)):M?(g=!1,p=fr(f)):p=[]:er(f)||Q(f)?(p=s,Q(s)?p=mr(s):(!T(s)||q(s))&&(p=lr(f))):g=!1}g&&(u.set(f,p),o(p,f,r,a,u),u.delete(f)),ee(e,n,p)}function Re(e,t,n,r,o){e!==t&&pr(t,function(a,u){if(o||(o=new A),T(a))yr(e,t,u,n,Re,r,o);else{var s=r?r(te(e,u),a,u+"",e,t,o):void 0;s===void 0&&(s=a),ee(e,u,s)}},Pe)}var xe=zt(function(e,t,n){Re(e,t,n)});function vr(e){const{render:t,defaultConfig:n={},appendTo:r,configTransformer:o}=e;return function(a={}){const u=c.getCurrentInstance();return function(f,h={}){const p=xe({},n,h),g=c.ref(!0),v={value:null},O=c.defineComponent({setup:()=>{const H=c.ref(),K={componentRef:H,visible:g,onMounted:()=>{Promise.resolve().then(()=>{v.value.componentRef=H})},config:p,consumer:v};return()=>t(f,K)}});let d={...xe(a,{appendTo:r||a.appendTo}),...p,visible:g};return o&&(d=o(d,a)),v.value=ae(u,c.h(O),d),v.value}}}i.CommandComponentConsumerInjectKey=L,i.CommandComponentStackInjectKey=W,i.CommandProviderWithRender=ae,i.ConsumerEventBus=ne,i.EVENT_NAME=C,i.PromiseWithResolvers=re,i.RxRender=He,i.activeConsumers=R,i.busName2EventName=De,i.createAdapter=vr,i.destroyAllConsumer=Ge,i.eventName2BusName=Be,i.getMaxZIndex=Fe,i.isNull=Ue,i.useConsumer=Ke,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
