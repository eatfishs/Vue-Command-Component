(function(s,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("vue"),require("element-plus"),require("vant"),require("vue-router")):typeof define=="function"&&define.amd?define(["exports","vue","element-plus","vant","vue-router"],c):(s=typeof globalThis<"u"?globalThis:s||self,c(s.Vue3CommandDialog={},s.vue,s.elementPlus,s.vant,s.vueRouter))})(this,function(s,c,C,Ve,He){"use strict";var Ir=Object.defineProperty;var Mr=(s,c,C)=>c in s?Ir(s,c,{enumerable:!0,configurable:!0,writable:!0,value:C}):s[c]=C;var H=(s,c,C)=>Mr(s,typeof c!="symbol"?c+"":c,C);var E=(e=>(e.destroy="destroy",e))(E||{});class re{constructor(){H(this,"map",new WeakMap)}getEventsMapByConsumer(t){let n=this.map.get(t);return n||(n=new Map,this.map.set(t,n)),n}getEventsByConsumer(t,n){const r=this.getEventsMapByConsumer(t);let o=r.get(n);return o||(o=new Set,r.set(n,o)),o}on(t,n,r,o={}){const a=this.getEventsByConsumer(t,n);let i=r;o.once&&(i=(...u)=>{r(...u),this.off(t,n,i)}),a.add(i),o.callImmediatelyAfterDelay!==void 0&&setTimeout(()=>{i()},o.callImmediatelyAfterDelay||0)}once(t,n,r){this.on(t,n,r,{once:!0})}emit(t,n,...r){this.getEventsByConsumer(t,n).forEach(a=>a(...r))}off(t,n,r){this.getEventsByConsumer(t,n).delete(r)}}const Ge=(e="")=>e.slice(2).toLowerCase(),Ke=(e="")=>`on${e.charAt(0).toUpperCase()}${e.slice(1)}`,oe=()=>{let e=()=>{},t=()=>{};return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}},Le=e=>{var r;const t=((r=e.parentElement)==null?void 0:r.children)||[];let n=0;return Array.from(t).forEach(o=>{if(o!==e){const a=parseInt(window.getComputedStyle(o).zIndex);!isNaN(a)&&a>n&&(n=a)}}),+n},ae=e=>e==null,ie=(e,t,...n)=>{const r={...e},o=a=>{for(const i in a)if(a[i]&&typeof a[i]=="object"){const u=r[i]&&typeof r[i]=="object"?r[i]:{};r[i]=ie(u,a[i])}else r[i]=a[i]};return o(t),n.forEach(o),r},G=Symbol("CommandComponentConsumerInjectKey"),K=Symbol("CommandComponentStackInjectKey"),N=new re,R=new Set,se=()=>{R.forEach(e=>{e.destroy()})},ue=e=>({...e.parent?ue(e.parent):{},...e.provides});function ce(e,t,n){const r=(typeof n.appendTo=="string"?document.querySelector(n.appendTo):n.appendTo)||e.vnode.el.parentElement||document.body,o=(typeof n.appendTo=="string"?document.querySelector(n.appendTo):n.appendTo)||document.body,a=document.createElement("div");a.className=n.customClassName||"command-component-container";try{r.appendChild(a)}catch{console.warn("function appendChild call error. Fallback to  maybe document.body."),o.appendChild(a)}const i=()=>{n.visible.value=!1},u=()=>{n.visible.value=!0},l=()=>{c.nextTick(()=>{c.render(null,a),a.remove()})},{promise:p,resolve:d,reject:h}=oe(),g=3e3,P=(m=!1)=>{m?(i(),y.on(E.destroy,l,{once:!0,callImmediatelyAfterDelay:g})):(R.delete(y),y.stack.splice(y.stackIndex).forEach(_=>_.destroy(!0)))},V=m=>{d(m),P()},Er=m=>{h(m),P()},y={meta:n.meta||{},promise:p,resolve:d,reject:h,destroyWithResolve:V,destroyWithReject:Er,hide:i,show:u,destroy:P,container:a,visible:n.visible,on:(m,v,_={})=>N.on(y,m,v,_),once:(m,v)=>N.once(y,m,v),emit:(m,...v)=>N.emit(y,m,...v),off:(m,v)=>N.off(y,m,v),stack:[],stackIndex:-1,componentRef:void 0},Sr=c.defineComponent({setup(){for(const _ in n.provideProps)c.provide(_,n.provideProps[_]);const m={...ue(e)};for(const _ in m)c.provide(_,m[_]);c.provide(G,y);const v=c.inject(K,[]);return y.stackIndex=v.length,v.push(y),c.provide(K,v),y.stack=v,()=>c.h(t)}}),ne=c.createVNode(Sr,null,null);return ne.appContext=(e==null?void 0:e.appContext)||ne.appContext,c.render(ne,a),R.add(y),y}const We=(e=!0)=>{const t=()=>e&&console.warn(`Failed to get Consumer instance. Please note:
    1. This function needs to be called directly in the setup top level.
    2. Make sure to display this component inside a command dialog, or you can ignore this warning message by using warn parameter: getConsumer(false)`);return c.inject(G,()=>new Proxy({},{get:()=>t,apply:t}),!0)};var le=typeof global=="object"&&global&&global.Object===Object&&global,qe=typeof self=="object"&&self&&self.Object===Object&&self,j=le||qe||Function("return this")(),D=j.Symbol,de=Object.prototype,Ze=de.hasOwnProperty,Xe=de.toString,S=D?D.toStringTag:void 0;function Je(e){var t=Ze.call(e,S),n=e[S];try{e[S]=void 0;var r=!0}catch{}var o=Xe.call(e);return r&&(t?e[S]=n:delete e[S]),o}var Ye=Object.prototype,Qe=Ye.toString;function ke(e){return Qe.call(e)}var et="[object Null]",tt="[object Undefined]",fe=D?D.toStringTag:void 0;function B(e){return e==null?e===void 0?tt:et:fe&&fe in Object(e)?Je(e):ke(e)}function I(e){return e!=null&&typeof e=="object"}var L=Array.isArray;function T(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function pe(e){return e}var nt="[object AsyncFunction]",rt="[object Function]",ot="[object GeneratorFunction]",at="[object Proxy]";function W(e){if(!T(e))return!1;var t=B(e);return t==rt||t==ot||t==nt||t==at}var q=j["__core-js_shared__"],he=function(){var e=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function it(e){return!!he&&he in e}var st=Function.prototype,ut=st.toString;function ct(e){if(e!=null){try{return ut.call(e)}catch{}try{return e+""}catch{}}return""}var lt=/[\\^$.*+?()[\]{}|]/g,dt=/^\[object .+?Constructor\]$/,ft=Function.prototype,pt=Object.prototype,ht=ft.toString,mt=pt.hasOwnProperty,yt=RegExp("^"+ht.call(mt).replace(lt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function vt(e){if(!T(e)||it(e))return!1;var t=W(e)?yt:dt;return t.test(ct(e))}function gt(e,t){return e==null?void 0:e[t]}function Z(e,t){var n=gt(e,t);return vt(n)?n:void 0}var me=Object.create,bt=function(){function e(){}return function(t){if(!T(t))return{};if(me)return me(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function _t(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Ct(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Tt=800,wt=16,Pt=Date.now;function jt(e){var t=0,n=0;return function(){var r=Pt(),o=wt-(r-n);if(n=r,o>0){if(++t>=Tt)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Ot(e){return function(){return e}}var U=function(){try{var e=Z(Object,"defineProperty");return e({},"",{}),e}catch{}}(),At=U?function(e,t){return U(e,"toString",{configurable:!0,enumerable:!1,value:Ot(t),writable:!0})}:pe,Et=jt(At),St=9007199254740991,It=/^(?:0|[1-9]\d*)$/;function ye(e,t){var n=typeof e;return t=t??St,!!t&&(n=="number"||n!="symbol"&&It.test(e))&&e>-1&&e%1==0&&e<t}function X(e,t,n){t=="__proto__"&&U?U(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function x(e,t){return e===t||e!==e&&t!==t}var Mt=Object.prototype,$t=Mt.hasOwnProperty;function Nt(e,t,n){var r=e[t];(!($t.call(e,t)&&x(r,n))||n===void 0&&!(t in e))&&X(e,t,n)}function Rt(e,t,n,r){var o=!n;n||(n={});for(var a=-1,i=t.length;++a<i;){var u=t[a],l=void 0;l===void 0&&(l=e[u]),o?X(n,u,l):Nt(n,u,l)}return n}var ve=Math.max;function Dt(e,t,n){return t=ve(t===void 0?e.length-1:t,0),function(){for(var r=arguments,o=-1,a=ve(r.length-t,0),i=Array(a);++o<a;)i[o]=r[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=r[o];return u[t]=n(i),_t(e,this,u)}}function Bt(e,t){return Et(Dt(e,t,pe),e+"")}var Ut=9007199254740991;function ge(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ut}function J(e){return e!=null&&ge(e.length)&&!W(e)}function xt(e,t,n){if(!T(n))return!1;var r=typeof t;return(r=="number"?J(n)&&ye(t,n.length):r=="string"&&t in n)?x(n[t],e):!1}function zt(e){return Bt(function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,i=o>2?n[2]:void 0;for(a=e.length>3&&typeof a=="function"?(o--,a):void 0,i&&xt(n[0],n[1],i)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,a)}return t})}var Ft=Object.prototype;function be(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Ft;return e===n}function Vt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Ht="[object Arguments]";function _e(e){return I(e)&&B(e)==Ht}var Ce=Object.prototype,Gt=Ce.hasOwnProperty,Kt=Ce.propertyIsEnumerable,Y=_e(function(){return arguments}())?_e:function(e){return I(e)&&Gt.call(e,"callee")&&!Kt.call(e,"callee")};function Lt(){return!1}var Te=typeof s=="object"&&s&&!s.nodeType&&s,we=Te&&typeof module=="object"&&module&&!module.nodeType&&module,Wt=we&&we.exports===Te,Pe=Wt?j.Buffer:void 0,qt=Pe?Pe.isBuffer:void 0,je=qt||Lt,Zt="[object Arguments]",Xt="[object Array]",Jt="[object Boolean]",Yt="[object Date]",Qt="[object Error]",kt="[object Function]",en="[object Map]",tn="[object Number]",nn="[object Object]",rn="[object RegExp]",on="[object Set]",an="[object String]",sn="[object WeakMap]",un="[object ArrayBuffer]",cn="[object DataView]",ln="[object Float32Array]",dn="[object Float64Array]",fn="[object Int8Array]",pn="[object Int16Array]",hn="[object Int32Array]",mn="[object Uint8Array]",yn="[object Uint8ClampedArray]",vn="[object Uint16Array]",gn="[object Uint32Array]",f={};f[ln]=f[dn]=f[fn]=f[pn]=f[hn]=f[mn]=f[yn]=f[vn]=f[gn]=!0,f[Zt]=f[Xt]=f[un]=f[Jt]=f[cn]=f[Yt]=f[Qt]=f[kt]=f[en]=f[tn]=f[nn]=f[rn]=f[on]=f[an]=f[sn]=!1;function bn(e){return I(e)&&ge(e.length)&&!!f[B(e)]}function _n(e){return function(t){return e(t)}}var Oe=typeof s=="object"&&s&&!s.nodeType&&s,M=Oe&&typeof module=="object"&&module&&!module.nodeType&&module,Cn=M&&M.exports===Oe,Q=Cn&&le.process,Ae=function(){try{var e=M&&M.require&&M.require("util").types;return e||Q&&Q.binding&&Q.binding("util")}catch{}}(),Ee=Ae&&Ae.isTypedArray,Se=Ee?_n(Ee):bn;function Tn(e,t){var n=L(e),r=!n&&Y(e),o=!n&&!r&&je(e),a=!n&&!r&&!o&&Se(e),i=n||r||o||a,u=i?Vt(e.length,String):[],l=u.length;for(var p in e)i&&(p=="length"||o&&(p=="offset"||p=="parent")||a&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||ye(p,l))||u.push(p);return u}function wn(e,t){return function(n){return e(t(n))}}function Pn(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var jn=Object.prototype,On=jn.hasOwnProperty;function An(e){if(!T(e))return Pn(e);var t=be(e),n=[];for(var r in e)r=="constructor"&&(t||!On.call(e,r))||n.push(r);return n}function Ie(e){return J(e)?Tn(e):An(e)}var $=Z(Object,"create");function En(){this.__data__=$?$(null):{},this.size=0}function Sn(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var In="__lodash_hash_undefined__",Mn=Object.prototype,$n=Mn.hasOwnProperty;function Nn(e){var t=this.__data__;if($){var n=t[e];return n===In?void 0:n}return $n.call(t,e)?t[e]:void 0}var Rn=Object.prototype,Dn=Rn.hasOwnProperty;function Bn(e){var t=this.__data__;return $?t[e]!==void 0:Dn.call(t,e)}var Un="__lodash_hash_undefined__";function xn(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=$&&t===void 0?Un:t,this}function w(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}w.prototype.clear=En,w.prototype.delete=Sn,w.prototype.get=Nn,w.prototype.has=Bn,w.prototype.set=xn;function zn(){this.__data__=[],this.size=0}function z(e,t){for(var n=e.length;n--;)if(x(e[n][0],t))return n;return-1}var Fn=Array.prototype,Vn=Fn.splice;function Hn(e){var t=this.__data__,n=z(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Vn.call(t,n,1),--this.size,!0}function Gn(e){var t=this.__data__,n=z(t,e);return n<0?void 0:t[n][1]}function Kn(e){return z(this.__data__,e)>-1}function Ln(e,t){var n=this.__data__,r=z(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function b(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}b.prototype.clear=zn,b.prototype.delete=Hn,b.prototype.get=Gn,b.prototype.has=Kn,b.prototype.set=Ln;var Me=Z(j,"Map");function Wn(){this.size=0,this.__data__={hash:new w,map:new(Me||b),string:new w}}function qn(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function F(e,t){var n=e.__data__;return qn(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Zn(e){var t=F(this,e).delete(e);return this.size-=t?1:0,t}function Xn(e){return F(this,e).get(e)}function Jn(e){return F(this,e).has(e)}function Yn(e,t){var n=F(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function O(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}O.prototype.clear=Wn,O.prototype.delete=Zn,O.prototype.get=Xn,O.prototype.has=Jn,O.prototype.set=Yn;var $e=wn(Object.getPrototypeOf,Object),Qn="[object Object]",kn=Function.prototype,er=Object.prototype,Ne=kn.toString,tr=er.hasOwnProperty,nr=Ne.call(Object);function rr(e){if(!I(e)||B(e)!=Qn)return!1;var t=$e(e);if(t===null)return!0;var n=tr.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Ne.call(n)==nr}function or(){this.__data__=new b,this.size=0}function ar(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function ir(e){return this.__data__.get(e)}function sr(e){return this.__data__.has(e)}var ur=200;function cr(e,t){var n=this.__data__;if(n instanceof b){var r=n.__data__;if(!Me||r.length<ur-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new O(r)}return n.set(e,t),this.size=n.size,this}function A(e){var t=this.__data__=new b(e);this.size=t.size}A.prototype.clear=or,A.prototype.delete=ar,A.prototype.get=ir,A.prototype.has=sr,A.prototype.set=cr;var Re=typeof s=="object"&&s&&!s.nodeType&&s,De=Re&&typeof module=="object"&&module&&!module.nodeType&&module,lr=De&&De.exports===Re,Be=lr?j.Buffer:void 0;Be&&Be.allocUnsafe;function dr(e,t){return e.slice()}var Ue=j.Uint8Array;function fr(e){var t=new e.constructor(e.byteLength);return new Ue(t).set(new Ue(e)),t}function pr(e,t){var n=fr(e.buffer);return new e.constructor(n,e.byteOffset,e.length)}function hr(e){return typeof e.constructor=="function"&&!be(e)?bt($e(e)):{}}function mr(e){return function(t,n,r){for(var o=-1,a=Object(t),i=r(t),u=i.length;u--;){var l=i[++o];if(n(a[l],l,a)===!1)break}return t}}var yr=mr();function k(e,t,n){(n!==void 0&&!x(e[t],n)||n===void 0&&!(t in e))&&X(e,t,n)}function vr(e){return I(e)&&J(e)}function ee(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function gr(e){return Rt(e,Ie(e))}function br(e,t,n,r,o,a,i){var u=ee(e,n),l=ee(t,n),p=i.get(l);if(p){k(e,n,p);return}var d=a?a(u,l,n+"",e,t,i):void 0,h=d===void 0;if(h){var g=L(l),P=!g&&je(l),V=!g&&!P&&Se(l);d=l,g||P||V?L(u)?d=u:vr(u)?d=Ct(u):P?(h=!1,d=dr(l)):V?(h=!1,d=pr(l)):d=[]:rr(l)||Y(l)?(d=u,Y(u)?d=gr(u):(!T(u)||W(u))&&(d=hr(l))):h=!1}h&&(i.set(l,d),o(d,l,r,a,i),i.delete(l)),k(e,n,d)}function xe(e,t,n,r,o){e!==t&&yr(t,function(a,i){if(o||(o=new A),T(a))br(e,t,i,n,xe,r,o);else{var u=r?r(ee(e,i),a,i+"",e,t,o):void 0;u===void 0&&(u=a),k(e,i,u)}},Ie)}var ze=zt(function(e,t,n){xe(e,t,n)});class te{constructor(){H(this,"mountNode");H(this,"parentInstance");this.parentInstance=c.getCurrentInstance()}setMountNode(t){this.mountNode=t}createCommand(t){return(n,r={})=>{const o=c.ref(ae(t.visible)?!0:!!t.visible);return this.createConsumer(n,o,r,t)}}createConsumer(t,n,r,o){const a={value:null},i=c.defineComponent({setup:()=>{const p=c.ref(),d=()=>{Promise.resolve().then(()=>{a.value.componentRef=p})};return()=>this.renderComponent(t,{componentRef:p,visible:n.value,onMounted:d,config:r,consumer:a})}}),l={...ze(o,r),visible:n};return a.value=ce(this.parentInstance,c.h(i),l),a.value}}class _r extends te{renderComponent(t,n){const{componentRef:r,visible:o,onMounted:a,config:i,consumer:u}=n,l=d=>{d(),u.value.destroy()},p=(...d)=>{var h,g;return u.value.emit(E.destroy),(g=(h=i.attrs)==null?void 0:h.onClosed)==null?void 0:g.call(h,...d)};return c.createVNode(C.ElDialog,c.mergeProps({ref:r,modelValue:o,beforeClose:l,onVnodeMounted:a,title:i.title,width:i.width},{...i.attrs},{onClosed:p}),{default:()=>t,...i.slots})}}const Cr=(e={})=>{const t=new _r;return t.setMountNode(e.appendTo),t.createCommand(e)};class Tr extends te{renderComponent(t,n){const{componentRef:r,visible:o,onMounted:a,config:i,consumer:u}=n,l=d=>{d(),u.value.destroy()},p=(...d)=>{var h,g;return u.value.emit(E.destroy),(g=(h=i.attrs)==null?void 0:h.onClosed)==null?void 0:g.call(h,...d)};return c.createVNode(C.ElDrawer,c.mergeProps({ref:r,modelValue:o,beforeClose:l,onVnodeMounted:a},{title:i.title,...i.attrs},{onClosed:p}),{default:()=>t,...i.slots})}}const wr=(e={})=>{const t=new Tr;return t.setMountNode(e.appendTo),t.createCommand(e)},Pr={round:!0,lockScroll:!0,closeable:!0,style:{backgroundColor:"#fff",color:"#000"}};class jr extends te{renderComponent(t,n){const{componentRef:r,visible:o,onMounted:a,config:i,consumer:u}=n,l=()=>{u.value.destroy()};return c.createVNode(Ve.Popup,c.mergeProps({ref:r,show:o,onClickCloseIcon:l,onVnodeMounted:a},{...Pr,...i.attrs}),{default:()=>t,...i.slots})}}const Fe=(e={})=>{const t=new jr;return t.setMountNode(e.appendTo),t.createCommand(e)},Or=(e={})=>{const t=Fe(e);return(n,r={})=>{const o=ze({},r,{attrs:{position:"bottom",style:{width:"100vw"}}});return t(n,o)}},Ar=()=>{const e=He.useRoute();c.watch(()=>e.path,()=>{console.log("路由变化,关闭所有存在的弹窗"),se()})};s.CommandComponentConsumerInjectKey=G,s.CommandComponentStackInjectKey=K,s.CommandProviderWithRender=ce,s.ConsumerEventBus=re,s.EVENT_NAME=E,s.PromiseWithResolvers=oe,s.activeConsumers=R,s.busName2EventName=Ke,s.deepMerge=ie,s.destroyAllConsumer=se,s.eventName2BusName=Ge,s.getConsumer=We,s.getMaxZIndex=Le,s.isNull=ae,s.useCloseAllOnRouteChange=Ar,s.useElementPlusDialog=Cr,s.useElementPlusDrawer=wr,s.useVantUiPopup=Fe,s.useVantUiPopupOnBottom=Or,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
