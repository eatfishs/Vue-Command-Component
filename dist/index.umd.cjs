(function(s,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("vue"),require("element-plus"),require("vant"),require("vue-router")):typeof define=="function"&&define.amd?define(["exports","vue","element-plus","vant","vue-router"],i):(s=typeof globalThis<"u"?globalThis:s||self,i(s.Vue3CommandDialog={},s.Vue,s.ElementPlus,s.Vant,s.VueRouter))})(this,function(s,i,b,Ke,Ge){"use strict";var $r=Object.defineProperty;var Ir=(s,i,b)=>i in s?$r(s,i,{enumerable:!0,configurable:!0,writable:!0,value:b}):s[i]=b;var Fe=(s,i,b)=>Ir(s,typeof i!="symbol"?i+"":i,b);var g=(e=>(e.confirm="confirm",e.cancel="cancel",e.destory="destory",e))(g||{});class ne{constructor(){Fe(this,"map",new WeakMap)}getEventsMapByConsumer(t){let n=this.map.get(t);return n||(n=new Map,this.map.set(t,n)),n}getEventsByConsumer(t,n){const r=this.getEventsMapByConsumer(t);let o=r.get(n);return o||(o=new Set,r.set(n,o)),o}on(t,n,r,o={}){const a=this.getEventsByConsumer(t,n);let l=r;o.once&&(l=(...u)=>{r(...u),this.off(t,n,l)}),a.add(l),o.callAfterDelay!==void 0&&setTimeout(()=>{l()},o.callAfterDelay||0)}once(t,n,r){this.on(t,n,r,{once:!0})}emit(t,n,...r){this.getEventsByConsumer(t,n).forEach(a=>a(...r))}off(t,n,r){this.getEventsByConsumer(t,n).delete(r)}}const re=(e="")=>e.slice(2).toLowerCase(),G=(e="")=>`on${e.charAt(0).toUpperCase()}${e.slice(1)}`,oe=()=>{let e=()=>{},t=()=>{};return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}},He=e=>{var r;const t=((r=e.parentElement)==null?void 0:r.children)||[];let n=0;return Array.from(t).forEach(o=>{if(o!==e){const a=parseInt(window.getComputedStyle(o).zIndex);!isNaN(a)&&a>n&&(n=a)}}),n},M=e=>e==null,H=Symbol("CommandComponentConsumerInjectKey"),L=Symbol("CommandComponentStackInjectKey"),D=new ne,R=new Set,ae=()=>{console.log("destroyAllCommandComponentConsumer"),R.forEach(e=>{e.destroy()})},se=e=>({...e.parent?se(e.parent):{},...e.provides});function B(e,t,n){const r=(typeof n.appendTo=="string"?document.querySelector(n.appendTo):n.appendTo)||document.body,o=document.createElement("div");o.className=n.customClassName||"command-commponent-container",r.appendChild(o);const a=()=>{n.visible.value=!1},l=()=>{n.visible.value=!0},u=()=>{i.nextTick(()=>{i.render(null,o),o.remove()})},c=(h=!1)=>{h?(m.on(g.destory,u,{once:!0,callAfterDelay:3e3}),a()):(R.delete(m),m.stack.splice(m.stackIndex).forEach(v=>v.destroy(!0)))},{promise:p,resolve:f,reject:y}=oe(),T=h=>{f(h),c()},_=h=>{y(h),c()},m={meta:n.meta||{},promise:p,resolve:f,reject:y,destroyWithResolve:T,destroyWithReject:_,hide:a,show:l,destroy:c,container:o,visible:n.visible,on:(h,v,Sr={})=>D.on(m,h,v,Sr),once:(h,v)=>D.once(m,h,v),emit:(h,...v)=>D.emit(m,h,...v),off:(h,v)=>D.off(m,h,v),stack:[],stackIndex:-1,componentRef:void 0},Er=i.defineComponent({setup(){for(const v in n.provideProps)i.provide(v,n.provideProps[v]);i.provide(H,m);const h=i.inject(L,[]);return m.stackIndex=h.length,h.push(m),i.provide(L,h),m.stack=h,()=>t}}),N=i.createVNode(Er,null,null);return N.appContext=(e==null?void 0:e.appContext)||N.appContext,N.appContext.provides={...N.appContext.provides,...se(e)},i.render(N,o),R.add(m),m}const ie=(e=!0)=>{const t=()=>e&&console.warn(`别调用了欧尼酱~,这会儿没啥实际用途;没有根据CommandComponentConsumerInjectKey接收到注入数据.原因可能有两个:
    1.你可能对getConsumer进行了异步调用或条件调用,请在setup中直接调用.
    2.你没有在命令弹窗内展示该组件,这个时候你一般可以忽略该警告消息.`);return i.inject(H,()=>new Proxy({},{get:()=>t,apply:t}),!0)},Le=(...e)=>(console.warn("Warning: This API will be deprecated in the future, please use `getConsumer` instead."),ie(...e));let ue;const We=e=>{ue=e},qe=(e={})=>{const t=i.getCurrentInstance(),{locale:{t:n}}=b.useGlobalComponentSettings("message-box");return(o,a={})=>{const l=i.ref(M(e.immediately)?!0:!!e.immediately),u=B(t,i.h(i.defineComponent({setup(){const c=i.ref(),p=()=>{Promise.resolve().then(()=>{u.componentRef=c})},f=T=>{T(),u.destroy()},y=(...T)=>{var _,m;return u.emit(g.destory),(m=(_=a.attrs)==null?void 0:_.onClosed)==null?void 0:m.call(_,...T)};return()=>i.createVNode(b.ElDialog,i.mergeProps({ref:c,modelValue:l.value,beforeClose:f,onVnodeMounted:p},{title:a.title,width:a.width,...a.attrs},{onClosed:y}),{default:()=>o,footer:()=>i.createVNode("div",null,[a[G(g.cancel)]&&i.createVNode(b.ElButton,{onClick:()=>u.emit(g.cancel)},{default:()=>[a.cancelBtnText||n("el.messagebox.cancel")]}),a[G(g.confirm)]&&i.createVNode(b.ElButton,{type:"primary",onClick:()=>u.emit(g.confirm)},{default:()=>[a.confirmBtnText||n("el.messagebox.confirm")]})]),...a.slots})}})),{provideProps:a.provideProps||{},appendTo:ue||a.appendTo,visible:l,meta:{...(e==null?void 0:e.meta)||{name:"command-element-plus-dialog"},...(a==null?void 0:a.meta)||{}}});return Object.entries(a).filter(([c,p])=>c.startsWith("on")&&typeof p=="function").forEach(([c,p])=>{const f=re(c);u.on(f,p)}),u}};let le;const Ze=e=>{le=e},Xe=(e={})=>{const t=i.getCurrentInstance();return(r,o={})=>{const a=i.ref(M(e.immediately)?!0:!!e.immediately),l=B(t,i.h(i.defineComponent({setup(){const u=y=>{y(),l.destroy()},c=()=>{l.emit(g.destory)},p=i.ref(),f=()=>{Promise.resolve().then(()=>{l.componentRef=p})};return()=>i.createVNode(b.ElDrawer,i.mergeProps({ref:p,modelValue:a.value,beforeClose:u,onClosed:c,onVnodeMounted:f},{title:o.title,size:o.size,...o.attrs}),{default:()=>r,...o.slots})}})),{provideProps:o.provideProps||{},appendTo:le||o.appendTo,visible:a,meta:{...(e==null?void 0:e.meta)||{name:"command-element-plus-drawer"},...(o==null?void 0:o.meta)||{}}});return l}};var ce=typeof global=="object"&&global&&global.Object===Object&&global,Je=typeof self=="object"&&self&&self.Object===Object&&self,j=ce||Je||Function("return this")(),V=j.Symbol,de=Object.prototype,Ye=de.hasOwnProperty,Qe=de.toString,E=V?V.toStringTag:void 0;function ke(e){var t=Ye.call(e,E),n=e[E];try{e[E]=void 0;var r=!0}catch{}var o=Qe.call(e);return r&&(t?e[E]=n:delete e[E]),o}var et=Object.prototype,tt=et.toString;function nt(e){return tt.call(e)}var rt="[object Null]",ot="[object Undefined]",pe=V?V.toStringTag:void 0;function x(e){return e==null?e===void 0?ot:rt:pe&&pe in Object(e)?ke(e):nt(e)}function S(e){return e!=null&&typeof e=="object"}var W=Array.isArray;function P(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function fe(e){return e}var at="[object AsyncFunction]",st="[object Function]",it="[object GeneratorFunction]",ut="[object Proxy]";function q(e){if(!P(e))return!1;var t=x(e);return t==st||t==it||t==at||t==ut}var Z=j["__core-js_shared__"],me=function(){var e=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function lt(e){return!!me&&me in e}var ct=Function.prototype,dt=ct.toString;function pt(e){if(e!=null){try{return dt.call(e)}catch{}try{return e+""}catch{}}return""}var ft=/[\\^$.*+?()[\]{}|]/g,mt=/^\[object .+?Constructor\]$/,ht=Function.prototype,yt=Object.prototype,vt=ht.toString,bt=yt.hasOwnProperty,gt=RegExp("^"+vt.call(bt).replace(ft,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _t(e){if(!P(e)||lt(e))return!1;var t=q(e)?gt:mt;return t.test(pt(e))}function Ct(e,t){return e==null?void 0:e[t]}function X(e,t){var n=Ct(e,t);return _t(n)?n:void 0}var he=Object.create,Tt=function(){function e(){}return function(t){if(!P(t))return{};if(he)return he(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Pt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function wt(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var jt=800,Ot=16,At=Date.now;function Et(e){var t=0,n=0;return function(){var r=At(),o=Ot-(r-n);if(n=r,o>0){if(++t>=jt)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function St(e){return function(){return e}}var z=function(){try{var e=X(Object,"defineProperty");return e({},"",{}),e}catch{}}(),$t=z?function(e,t){return z(e,"toString",{configurable:!0,enumerable:!1,value:St(t),writable:!0})}:fe,It=Et($t),Nt=9007199254740991,Mt=/^(?:0|[1-9]\d*)$/;function ye(e,t){var n=typeof e;return t=t??Nt,!!t&&(n=="number"||n!="symbol"&&Mt.test(e))&&e>-1&&e%1==0&&e<t}function J(e,t,n){t=="__proto__"&&z?z(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function U(e,t){return e===t||e!==e&&t!==t}var Dt=Object.prototype,Rt=Dt.hasOwnProperty;function Bt(e,t,n){var r=e[t];(!(Rt.call(e,t)&&U(r,n))||n===void 0&&!(t in e))&&J(e,t,n)}function Vt(e,t,n,r){var o=!n;n||(n={});for(var a=-1,l=t.length;++a<l;){var u=t[a],c=void 0;c===void 0&&(c=e[u]),o?J(n,u,c):Bt(n,u,c)}return n}var ve=Math.max;function xt(e,t,n){return t=ve(t===void 0?e.length-1:t,0),function(){for(var r=arguments,o=-1,a=ve(r.length-t,0),l=Array(a);++o<a;)l[o]=r[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=r[o];return u[t]=n(l),Pt(e,this,u)}}function zt(e,t){return It(xt(e,t,fe),e+"")}var Ut=9007199254740991;function be(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ut}function Y(e){return e!=null&&be(e.length)&&!q(e)}function Ft(e,t,n){if(!P(n))return!1;var r=typeof t;return(r=="number"?Y(n)&&ye(t,n.length):r=="string"&&t in n)?U(n[t],e):!1}function Kt(e){return zt(function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,l=o>2?n[2]:void 0;for(a=e.length>3&&typeof a=="function"?(o--,a):void 0,l&&Ft(n[0],n[1],l)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,a)}return t})}var Gt=Object.prototype;function ge(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Gt;return e===n}function Ht(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Lt="[object Arguments]";function _e(e){return S(e)&&x(e)==Lt}var Ce=Object.prototype,Wt=Ce.hasOwnProperty,qt=Ce.propertyIsEnumerable,Q=_e(function(){return arguments}())?_e:function(e){return S(e)&&Wt.call(e,"callee")&&!qt.call(e,"callee")};function Zt(){return!1}var Te=typeof s=="object"&&s&&!s.nodeType&&s,Pe=Te&&typeof module=="object"&&module&&!module.nodeType&&module,Xt=Pe&&Pe.exports===Te,we=Xt?j.Buffer:void 0,Jt=we?we.isBuffer:void 0,je=Jt||Zt,Yt="[object Arguments]",Qt="[object Array]",kt="[object Boolean]",en="[object Date]",tn="[object Error]",nn="[object Function]",rn="[object Map]",on="[object Number]",an="[object Object]",sn="[object RegExp]",un="[object Set]",ln="[object String]",cn="[object WeakMap]",dn="[object ArrayBuffer]",pn="[object DataView]",fn="[object Float32Array]",mn="[object Float64Array]",hn="[object Int8Array]",yn="[object Int16Array]",vn="[object Int32Array]",bn="[object Uint8Array]",gn="[object Uint8ClampedArray]",_n="[object Uint16Array]",Cn="[object Uint32Array]",d={};d[fn]=d[mn]=d[hn]=d[yn]=d[vn]=d[bn]=d[gn]=d[_n]=d[Cn]=!0,d[Yt]=d[Qt]=d[dn]=d[kt]=d[pn]=d[en]=d[tn]=d[nn]=d[rn]=d[on]=d[an]=d[sn]=d[un]=d[ln]=d[cn]=!1;function Tn(e){return S(e)&&be(e.length)&&!!d[x(e)]}function Pn(e){return function(t){return e(t)}}var Oe=typeof s=="object"&&s&&!s.nodeType&&s,$=Oe&&typeof module=="object"&&module&&!module.nodeType&&module,wn=$&&$.exports===Oe,k=wn&&ce.process,Ae=function(){try{var e=$&&$.require&&$.require("util").types;return e||k&&k.binding&&k.binding("util")}catch{}}(),Ee=Ae&&Ae.isTypedArray,Se=Ee?Pn(Ee):Tn;function jn(e,t){var n=W(e),r=!n&&Q(e),o=!n&&!r&&je(e),a=!n&&!r&&!o&&Se(e),l=n||r||o||a,u=l?Ht(e.length,String):[],c=u.length;for(var p in e)l&&(p=="length"||o&&(p=="offset"||p=="parent")||a&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||ye(p,c))||u.push(p);return u}function On(e,t){return function(n){return e(t(n))}}function An(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var En=Object.prototype,Sn=En.hasOwnProperty;function $n(e){if(!P(e))return An(e);var t=ge(e),n=[];for(var r in e)r=="constructor"&&(t||!Sn.call(e,r))||n.push(r);return n}function $e(e){return Y(e)?jn(e):$n(e)}var I=X(Object,"create");function In(){this.__data__=I?I(null):{},this.size=0}function Nn(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Mn="__lodash_hash_undefined__",Dn=Object.prototype,Rn=Dn.hasOwnProperty;function Bn(e){var t=this.__data__;if(I){var n=t[e];return n===Mn?void 0:n}return Rn.call(t,e)?t[e]:void 0}var Vn=Object.prototype,xn=Vn.hasOwnProperty;function zn(e){var t=this.__data__;return I?t[e]!==void 0:xn.call(t,e)}var Un="__lodash_hash_undefined__";function Fn(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=I&&t===void 0?Un:t,this}function w(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}w.prototype.clear=In,w.prototype.delete=Nn,w.prototype.get=Bn,w.prototype.has=zn,w.prototype.set=Fn;function Kn(){this.__data__=[],this.size=0}function F(e,t){for(var n=e.length;n--;)if(U(e[n][0],t))return n;return-1}var Gn=Array.prototype,Hn=Gn.splice;function Ln(e){var t=this.__data__,n=F(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Hn.call(t,n,1),--this.size,!0}function Wn(e){var t=this.__data__,n=F(t,e);return n<0?void 0:t[n][1]}function qn(e){return F(this.__data__,e)>-1}function Zn(e,t){var n=this.__data__,r=F(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function C(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}C.prototype.clear=Kn,C.prototype.delete=Ln,C.prototype.get=Wn,C.prototype.has=qn,C.prototype.set=Zn;var Ie=X(j,"Map");function Xn(){this.size=0,this.__data__={hash:new w,map:new(Ie||C),string:new w}}function Jn(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function K(e,t){var n=e.__data__;return Jn(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Yn(e){var t=K(this,e).delete(e);return this.size-=t?1:0,t}function Qn(e){return K(this,e).get(e)}function kn(e){return K(this,e).has(e)}function er(e,t){var n=K(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function O(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}O.prototype.clear=Xn,O.prototype.delete=Yn,O.prototype.get=Qn,O.prototype.has=kn,O.prototype.set=er;var Ne=On(Object.getPrototypeOf,Object),tr="[object Object]",nr=Function.prototype,rr=Object.prototype,Me=nr.toString,or=rr.hasOwnProperty,ar=Me.call(Object);function sr(e){if(!S(e)||x(e)!=tr)return!1;var t=Ne(e);if(t===null)return!0;var n=or.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Me.call(n)==ar}function ir(){this.__data__=new C,this.size=0}function ur(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function lr(e){return this.__data__.get(e)}function cr(e){return this.__data__.has(e)}var dr=200;function pr(e,t){var n=this.__data__;if(n instanceof C){var r=n.__data__;if(!Ie||r.length<dr-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new O(r)}return n.set(e,t),this.size=n.size,this}function A(e){var t=this.__data__=new C(e);this.size=t.size}A.prototype.clear=ir,A.prototype.delete=ur,A.prototype.get=lr,A.prototype.has=cr,A.prototype.set=pr;var De=typeof s=="object"&&s&&!s.nodeType&&s,Re=De&&typeof module=="object"&&module&&!module.nodeType&&module,fr=Re&&Re.exports===De,Be=fr?j.Buffer:void 0;Be&&Be.allocUnsafe;function mr(e,t){return e.slice()}var Ve=j.Uint8Array;function hr(e){var t=new e.constructor(e.byteLength);return new Ve(t).set(new Ve(e)),t}function yr(e,t){var n=hr(e.buffer);return new e.constructor(n,e.byteOffset,e.length)}function vr(e){return typeof e.constructor=="function"&&!ge(e)?Tt(Ne(e)):{}}function br(e){return function(t,n,r){for(var o=-1,a=Object(t),l=r(t),u=l.length;u--;){var c=l[++o];if(n(a[c],c,a)===!1)break}return t}}var gr=br();function ee(e,t,n){(n!==void 0&&!U(e[t],n)||n===void 0&&!(t in e))&&J(e,t,n)}function _r(e){return S(e)&&Y(e)}function te(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function Cr(e){return Vt(e,$e(e))}function Tr(e,t,n,r,o,a,l){var u=te(e,n),c=te(t,n),p=l.get(c);if(p){ee(e,n,p);return}var f=a?a(u,c,n+"",e,t,l):void 0,y=f===void 0;if(y){var T=W(c),_=!T&&je(c),m=!T&&!_&&Se(c);f=c,T||_||m?W(u)?f=u:_r(u)?f=wt(u):_?(y=!1,f=mr(c)):m?(y=!1,f=yr(c)):f=[]:sr(c)||Q(c)?(f=u,Q(u)?f=Cr(u):(!P(u)||q(u))&&(f=vr(c))):y=!1}y&&(l.set(c,f),o(f,c,r,a,l),l.delete(c)),ee(e,n,f)}function xe(e,t,n,r,o){e!==t&&gr(t,function(a,l){if(o||(o=new A),P(a))Tr(e,t,l,n,xe,r,o);else{var u=r?r(te(e,l),a,l+"",e,t,o):void 0;u===void 0&&(u=a),ee(e,l,u)}},$e)}var Pr=Kt(function(e,t,n){xe(e,t,n)});let ze;const wr=e=>{ze=e},jr={round:!0,lockScroll:!0,closeable:!0,style:{backgroundColor:"#fff",color:"#000"}},Ue=(e={})=>{const t=i.getCurrentInstance();return(r,o={})=>{const a=i.ref(M(e.immediately)?!0:!!e.immediately),l=B(t,i.h(i.defineComponent({setup(){const u=()=>{l.destroy()},c=()=>{l.emit(g.destory)},p=i.ref(),f=()=>{Promise.resolve().then(()=>{l.componentRef=p})};return()=>i.createVNode(Ke.Popup,i.mergeProps({ref:p,show:a.value,onClickCloseIcon:u,onClosed:c,onVnodeMounted:f},{...jr,...o.attrs}),{default:()=>r,...o.slots})}})),{provideProps:o.provideProps||{},appendTo:ze||o.appendTo,visible:a,meta:{...(e==null?void 0:e.meta)||{name:"command-vant-ui-popup"},...(o==null?void 0:o.meta)||{}}});return l}},Or=(e={})=>{const t=Ue(e);return(n,r={})=>(Pr(r,{attrs:{position:"bottom",style:{width:"100vw"}}}),t(n,r))},Ar=()=>{const e=Ge.useRoute();i.watch(()=>e.path,()=>{console.log("路由变化,关闭所有存在的弹窗"),ae()})};s.CommandComponentConsumerInjectKey=H,s.CommandComponentStackInjectKey=L,s.CommandProvider=B,s.ConsumerEventBus=ne,s.EVENT_NAME=g,s.PromiseWithResolvers=oe,s.activeCommandComponentConsumers=R,s.busName2EventName=G,s.createElementPlusDialog=qe,s.createElementPlusDrawer=Xe,s.createVantUiPopup=Ue,s.createVantUiPopupOnBottom=Or,s.destroyAllCommandComponentConsumer=ae,s.eventName2BusName=re,s.getCommandDialogConsumer=Le,s.getConsumer=ie,s.getMaxZIndex=He,s.isNull=M,s.setElementPlusDialogMountNode=We,s.setElementPlusDrawerMountNode=Ze,s.setVantUiPopupMountNode=wr,s.useAfterRouteChangeCloseAllCommandComponent=Ar,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
